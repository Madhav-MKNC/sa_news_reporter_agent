<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>SA News — Drafts</title>
        <style>
            body {
                font-family: Arial;
                margin: 20px;
            }
            .card {
                border: 1px solid #ddd;
                padding: 12px;
                border-radius: 8px;
                margin-bottom: 10px;
            }
            button {
                margin: 4px 6px;
            }
            pre {
                white-space: pre-wrap;
            }
        </style>
    </head>
    <body>
        <h2>SA News — Drafts</h2>
        <div id="list">Loading…</div>

        <script>
            async function load() {
                const res = await fetch("/api/candidates");
                const items = await res.json();
                document.getElementById("list").innerHTML =
                    items
                        .map((c) => {
                            return `
      <div class="card">
        <b>${c.headline}</b><br><small>${c.created_at}</small><hr>
        ${c.variants
            .map(
                (v) => `
          <div>
            <pre>${v.text}</pre>
            <button onclick='openX(${JSON.stringify(
                v.text
            )})'>Open on X</button>
            <button onclick='copyT(${JSON.stringify(v.text)})'>Copy</button>
          </div>
        `
            )
            .join("")}
      </div>`;
                        })
                        .join("") || "No drafts.";
            }

            function openX(text) {
                const url =
                    "https://x.com/intent/post?text=" +
                    encodeURIComponent(text);
                window.open(url, "_blank");
            }

            function copyT(text) {
                navigator.clipboard.writeText(text);
                alert("Copied");
            }

            load();
        </script>
    </body>
</html>
